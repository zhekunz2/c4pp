functions{
    matrix L_cov_exp_quad_ARD(vector[] x,float alpha,vector rho,float delta){
        matrix[size(x),size(x)] K
        float neg_half
        float sq_alpha

        neg_half = -0.5
        sq_alpha = square(alpha)
        for(i in 1:(size(x)-1))
        {
            K[i,i] = sq_alpha+delta
            for(j in (i+1):size(x))
            {
                K[i,j] = sq_alpha*exp(neg_half*dot_self((x[i]-x[j])./rho))
                K[j,i] = K[i,j]
            }
        }
        K[size(x),size(x)] = sq_alpha+delta
        return(cholesky_decompose(K))
    }
}
D : 2
N : 101
y : <2.1633308553, 0.456685453739, -0.716468331278, 0.0191464069565, -0.195673966588, 0.992242347416, 0.614057916758, -1.05709646375, 0.696909490275, 0.512463253128, 0.662001920396, 0.872565740327, -1.11459614539, 1.69024772549, 0.665667824595, 2.05780148393, 0.275631476396, 0.502378184602, 1.70311679886, -0.112242825853, 0.472951008633, 2.57029464085, -0.374900537327, 0.579522092733, -1.11907039423, -0.0296217792075, 0.926962346861, -0.132791198418, 1.33462800418, -0.412806270448, -0.227234683525, 0.359987619843, -0.154919601426, 0.18935461575, 1.41882513592, 1.68384262793, 0.0143735566656, 0.530046043581, -0.397265653945, 1.34791126291, -0.492236336299, -0.54399643486, 0.687755818257, 0.563219229034, -1.26439939292, -0.13102308978, -0.907742938921, 1.65162487182, -0.748754901021, -0.609888878526, 1.13713668497, -0.0311542401319, 1.845466621, 0.634675733343, -0.0316544588464, 1.97563700395, -0.167833564108, -0.747966085076, 2.15161003523, 1.65885987514, -0.907706879259, -0.124014321909, 1.64034734155, 2.53878064194, 0.206394868028, -0.55810207065, 0.645179575253, -0.204160893968, 0.608635719936, 0.964176226239, 1.22827611607, 0.102678247848, -0.926314741328, 0.0460721010768, -0.159729327587, 1.92937209244, 1.16859269838, 2.55011381088, -1.22043172084, -0.0461706428173, -0.192212385806, -0.181695015358, 0.277254668919, -1.13992943203, 0.4477613059, 1.74169355429, 0.593967013782, -0.87966673594, 0.676792155567, 0.279752915571, 1.92182718475, 0.162444047612, 0.638457674251, -1.4370784423, -0.126933074239, -0.843768586085, 1.80668703234, 1.57981542626, 2.40419958835, 0.549299570701, 0.802835774198>[N]
x: [<2.0,-0.04>,<0.56,0.4>,<-0.36,-1.92>,<1.36,0.76>,<-1.88,-0.72>,<-1.16,0.96>,<0.12,1.0>,<-0.12,1.64>,<-1.6,-1.16>,<1.16,1.28>,<-1.16,-1.84>,<1.6,-1.88>,<0.72,-2.0>,<-2.0,-0.88>,<1.8,0.64>,<1.44,-0.84>,<-1.28,-2.0>,<1.16,-1.64>,<-0.92,0.4>,<1.0,1.64>,<-0.16,1.96>,<-1.88,-1.44>,<0.24,1.4>,<1.48,-1.84>,<0.96,1.6>,<1.52,0.6>,<1.88,-0.84>,<0.76,-0.84>,<-0.44,0.96>,<1.64,-1.04>,<0.64,-0.72>,<-0.84,1.28>,<-1.12,0.4>,<-0.72,1.0>,<-1.8,-1.56>,<0.4,0.24>,<-1.24,-0.52>,<-1.36,1.76>,<1.24,1.4>,<1.84,-1.76>,<1.8,-1.64>,<0.64,0.0>,<-1.08,-1.28>,<-0.68,0.92>,<-0.36,0.12>,<-1.4,0.08>,<-0.84,0.2>,<1.16,0.04>,<1.88,1.36>,<1.96,0.84>,<0.32,1.24>,<1.0,-1.4>,<-1.52,1.92>,<-0.24,-0.16>,<-1.36,0.36>,<-0.92,-1.08>,<0.76,-0.88>,<1.24,-1.64>,<1.28,-0.28>,<1.04,0.64>,<-0.24,0.52>,<-2.0,-1.16>,<0.84,-1.16>,<1.28,-0.76>,<0.76,1.72>,<-1.56,-1.52>,<0.72,-0.28>,<1.36,1.88>,<-1.72,-0.16>,<0.8,-1.68>,<1.96,-1.0>,<-1.84,0.76>,<1.16,-0.6>,<-0.56,-0.88>,<-1.68,-0.56>,<-1.32,0.12>,<0.0,1.76>,<-0.64,-0.16>,<-1.68,1.44>,<-0.44,0.92>,<-1.32,-0.2>,<1.08,-1.76>,<1.24,-0.8>,<-0.56,-0.76>,<-1.88,0.08>,<0.72,1.6>,<-1.92,1.96>,<-0.8,1.76>,<0.72,2.0>,<1.24,-1.88>,<0.96,-0.64>,<1.32,0.12>,<-0.92,1.2>,<-1.64,1.32>,<-0.92,1.0>,<1.84,-1.68>,<1.4,1.2>,<-0.48,-0.72>,<-1.2,0.24>,<1.52,0.08>,<0.32,0.64>][N,D]
transformeddata{
    float delta
    delta = 0.000000001
}
vector[N] f
matrix[N,N] L_K
L_K = L_cov_exp_quad_ARD(x,alpha,rho,delta)
f = L_K*eta
rho := invgamma<D>(5.0,5.0) <lower=0>
alpha := normal(0.0,1.0) <lower=0>
sigma := normal(0.0,1.0) <lower=0>
eta := normal<N>(0.0,1.0)
observe(normal(f,sigma),y)
posterior(alpha)
posterior(eta)
posterior(sigma)
posterior(rho)
