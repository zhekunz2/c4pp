K : 3
N : 1000
y : [-2.67579415028478, -0.312379280212805, -2.31986116656571,-2.32527403171733, -1.49596709146533, -3.0471225682095, -0.784143076920335,-1.98730353839556, -2.57835755588148, -1.83055866989906, -0.420256585154024,-0.893015249009594, -2.21139275595987, -2.01064974900796, -1.45514070844951,-1.37290042189812, -3.17561482145171, -2.83301861156866, -4.04683872725336,-2.0225980811318, -0.308176251465757, -1.79523500406455, -3.29541456701901,0.640203666819834, -1.94420063669444, -0.604952501914146, -2.01642666405615,-2.72630901931672, -2.74714775064267, -0.769403712216148, -3.10980169855643,-2.92343660687669, -1.46175216626216, -2.29848374334973, -1.32381947469045,-3.11789530143882, -1.34624579223274, -1.84268790050324, -1.62134334671437,-2.59066445108009, -3.19568970002234, -0.803353549221638, -0.453024538861819,-1.58559244702985, -1.31465905562316, -2.9295461447253, -1.91653139020667,-1.88913062575166, -1.965703750751, -1.63653981106555, -3.90336477465287,-2.75185412739402, -0.409772876462149, -0.152609160923018, -1.70577140904254,-3.92309806948794, -1.07716997691815, -2.7921669471237, -1.37947551206262,-1.97707891782351, -2.48288188167558, -0.809405336826188, -1.2457789905317,-1.15482114808109, -2.68877527660777, -4.03997063693086, -1.01251811094364,-2.13785747082808, 0.164032573794941, -2.31901698555768, -2.71585412710126,-3.41853348591551, -2.32515200499632, -2.71796844257389, -2.04376483019385,-2.14999870764952, -1.3675481159708, -1.61627366586411, -3.08511120337635,-4.02132104930949, -2.44095376597383, -2.29519618774519, -3.51164132266919,-1.65553692097391, -3.86647208391619, -1.19133316742162, -0.585088903319236,-3.30941144076877, -1.59726312700569, -2.02247896422479, -1.51221303559883,-2.37106022510738, -0.15062318002233, -2.65698926284571, -2.1438439233223,-2.3827857200474, -2.98917165545449, -2.19292075586894, -1.91722819871123,-2.45456362186612, -2.93126079086079, -1.71675670327421, -2.98390359578501,-1.75782997085703, -2.36995999994096, -2.40266277971588, -2.09222969013093,-2.86950806297338, -3.4830530608069, -1.88336136433051, -2.95849669204269,-1.09890550208358, -0.84558160250711, 0.503963205683594, -1.40975999970496,-3.45927884616698, -3.08126684885313, -0.0898664733988301, -1.98883231496984,-1.27824891682744, -1.87034095977861, -1.990688122177, -1.3367229429254,-2.32317642158934, -2.7866756453318, -1.03653760236319, -2.72054206920085,-2.84702598771795, -2.68084077947312, -2.59180858764618, -2.54007197370644,-1.05926466175482, -0.752535321937371, -1.00572104284776, -0.826311403576203,-2.26777117781952, -0.758538845146434, -1.9014547844189, -0.803400167190012,-1.63751692924285, -2.10782146156823, -1.38692613038128, -2.44745591492922,-1.6801651951233, -3.27858431217903, -1.26157450946566, -1.824626628717,-2.15027414485173, -2.26227429476214, -3.6663684959752, -2.47855950622827,-1.62295709445192, 1.50564708842436, -2.45629738708476, -3.18478968718166,-3.8485836893032, -0.565476090996156, -2.94241153786954, -1.28007170465019,-0.962029725360914, -2.51252523814299, -2.61741514031814, -2.42243573765986,-2.34206808902495, 0.0114101594749507, -0.961925127197192, -4.54640525812785,-1.61782886880777, -3.93015992409023, -3.7418444525796, -2.67722485944827,-2.70062413920305, -3.11170353916027, -2.19489412599363, -3.57780714723389,-1.50799400020768, -1.01485894229432, -0.67411372129918, -3.7106454999055,-1.90351920565778, -1.43344447848979, -1.87521494026343, -2.42781035401419,-1.40231881449418, -1.3685616581818, -1.02858253691789, -2.38795982375235,-4.08031547297736, -3.12985461586223, -0.913123006152439, -2.85639884468264,-1.66843722231444, -3.48875938165227, -3.02950214285389, -3.37444915388364,-2.18290994132225, -3.2034188672929, -1.93830065003631, -2.55061422400337,-0.561696847394792, -2.12080004609532, -2.34334607148102, -3.4187624036023,-1.54292053269079, -3.94057121536747, -0.428651165736605, 0.781124869208276,-3.66900944056076, -2.06843333660792, -2.40962269983563, -2.32601390021923,-2.55503585833264, -2.26220471866836, -1.4553413070276, -2.81916339034988,-0.543467501479159, -1.23851672595383, -2.0121464474173, -2.79709452535101,-3.41815411662964, -1.35509903516934, -1.43629281219314, -1.99733700906727,-3.18105752729816, -1.79833045484912, -1.76058158468792, -0.388589322272492,0.165862218136564, -0.767256761332897, -2.3865026678482, -3.3391669520232,-2.30009481101407, -1.09421554724135, -1.02791405273625, -1.78447181701413,-2.64204482629333, -2.10570148306179, -1.79623281139553, -1.41364597790014,-1.02740081382305, -2.49488237161546, -1.47136799493372, -1.44236213964576,-2.80950781196605, -0.816999770256665, -1.00488918887143, -3.87091183630247,-1.43411018606042, -2.34480026787106, -1.38603846897113, -0.983478931411851,-1.52147262546501, -0.733885209555363, -2.37868849304003, -2.19642267554564,-1.46818674204109, -1.22881993964366, -2.10454134025344, -1.58013066541228,-1.35612703772375, -4.08116555044653, -2.71317149019838, -2.17165557280181,-2.35290310357614, -1.66790286474075, -0.405237341357199, -0.579705280576444,-1.96383083036662, -2.93444373537819, -1.33319432545027, -1.12253632147091,-0.279248676499214, -2.56009849503853, -0.797874441991169, -2.73469696232246,-3.88199785823292, -1.53564278557102, -0.99982080204605, -1.11680743679184,-1.02587627538202, -1.63023297498114, -2.59492168079305, -1.64916788881508,-3.0910336288121, -1.02730048324504, -1.65222492879299, -1.03408925727615,-1.97134031829021, -3.00264414970528, -4.7258784956483, -3.00243036767084,-2.27849181484379, -1.08192995802033, -1.82697726976826, -1.52007866444074,-2.72178698289814, -2.39410632301572, -3.91153358162588, -2.38161165077503,-2.135728036602, -1.85674192268921, -1.15133986552562, -3.09402119748408,-1.62359890022981, -3.99179087009687, -2.00408421276519, -1.20877206334981,-3.03481467191127, -2.58123837452284, -0.620857959045034, -2.7007520777123,-1.75463177639935, -2.45173819356142, -2.81026890600737, -2.14244634161626,-1.1604319028261, -1.95643516790237, 0.571210374480344, -2.20828361541147,-1.79579474266334, -1.93668094838014, -1.89021698477148, -3.92091693462589,-1.81612448361063, -3.8304263824922, -1.72450232675454, -2.9325842022398,-2.12613479439156, -2.83729714865486, -0.706202695112604, -2.80246294765555,-2.26512986886968, -1.66591347289189, 0.158707206634937, -2.32148498755005,-1.30250507904997, -0.0272372607428786, -2.62210710863317, -1.63606357117015,-1.91409018073233, -3.04359983525905, -1.28813825012839, -1.85635697142453,-2.25819204820443, -2.703156958083, 0.00346507172529176, 0.473437041218548,-2.8371630269282, -1.95996577040946, -3.26045316537495, -0.724852219524466,-3.05302081674765, -2.52148415489556, -1.06758708545396, -0.936549590101153,-3.49918446935595, -1.81796162353493, -1.40912285974471, -2.58766394609848,-1.84166918455341, -2.70231886000817, -1.57654108682261, -0.752358817039287,-0.932583145924579, -2.39999067811521, -3.66898854581106, -2.43120148787237,-1.27874986662923, -3.00010656652309, -0.532234757752255, -1.19632727236996,-3.05512617125842, -1.31686735392847, -0.721843831196393, -2.27467730283824,-1.79230466672104, -2.69728813227947, -3.59442012405706, -3.20519065850611,-2.03123958512276, -2.42175850499775, -2.81694167972752, -4.32826559531628,-3.04568181121651, -2.63812577426523, -3.33022013809545, -2.28826085611576,-1.35910178771164, -0.842119118992098, -2.59698523207659, -4.52565983298007,-1.19768465735586, -5.24032502653064, -2.08888306982911, -0.0523053433451004,-3.31185561770908, -3.1960202602208, -1.38062191779269, -1.57051955117391,-2.01063122558557, -2.86390600790615, -1.02818842843318, -1.9167597702852,1.08743170154691, -3.64066397189815, -1.2551365406498, -3.76841480324592,-1.40254636268395, -2.29192271508765, -2.52778038964858, -1.57476482184809,-3.39045465363485, -2.01160459840951, -2.48533252807917, -2.02394382706444,-0.937845523390428, -2.32918415646655, -2.91343626354516, -0.533873773810632,-1.84971589174486, -1.70243620335512, -2.88699936107325, -1.43389330592142,-1.74762983398616, -3.49486263242282, -2.73307361393983, -2.22050219644031,-2.12226803956509, -2.83865029414681, -2.23132609452664, -1.29585549202236,-0.464533877005415, -4.28132146999122, -1.3022633655293, -1.81995689997499,-3.89375825970559, -2.83788836901212, -2.30948410087892, -0.287681754566022,-1.46580145198064, -3.43530802952723, -1.66226096326238, -1.41477742501303,-0.949472790454205, -1.40169489040383, -2.6145200241421, -1.89490991228567,-3.19299230837467, -2.05140655871685, -3.5567739453015, -0.785025700693129,-2.29452352533358, -1.99797091890407, -3.33793317053583, -1.28704953630813,-3.02879749186407, -0.769250135780661, -0.718752550256698, -2.58838115757813,-2.66715830334073, -1.1694987629507, -1.98309882962503, -3.36709725881357,-2.19703669037364, -1.29179455349033, -1.69919940649765, -1.90525901583373,-2.34199819389465, -2.93547532447893, -2.96515558302605, -3.30629991761404,-2.93211373180956, -1.83961766712543, -1.58540533004791, -2.46661705420937,-1.73963476563844, -1.81028843039358, -3.37149512102327, -0.42205753403022,-2.00828664732343, -3.62286608318888, -2.79786825977167, -1.055128627911,-2.2785643325891, -2.18207332022598, -2.7755945121164, -1.76871256606261,-0.170284992795453, -2.24949515600495, -2.00321380551331, -2.50313300906938,-3.81783668000343, -1.89747763515467, -1.75543387595844, -1.96663326535339,-2.53753114329942, -1.68879798122013, -1.8969705247843, -1.85769993815646,-2.07322889140009, 0.798414346040896, -0.211487965901607, 0.0700353415459969,0.408237421186226, 0.190351031683235, 0.44523753665436, -0.460385275782115,1.00615132393039, -0.205561397936653, 0.928923691506944, 0.495969431146249,0.0710947247825556, 0.848477143403621, 0.69799905771395, 0.767570146742176,0.188698648374682, -0.171135279976337, 0.517741207299334, 0.528146674218324,0.318790048090004, 1.18435514803706, -0.0750996897268654, 0.650489745213466,0.805640569263567, 1.1707665791468, 0.376841890698517, 0.398513140480276,1.67129186475443, -0.180463640531043, -0.283768249040649, 0.332309734811815,1.05972723568216, 0.679390579232546, 0.155213229322133, -0.373409635127302,0.565681163664299, 0.893135902039474, 0.653186105341494, 0.819525707586156,0.431434952145534, 0.941141822615659, 1.21405942175198, 0.288196684404784,0.41216266600554, 0.319791373641634, 0.165143926408076, 0.911292631277621,0.968675547589938, 0.0540288947563811, 1.21517361254248, 1.13454740067633,0.780673441746191, 0.338875170542366, -0.00176969214595202, 0.750750438391209,0.893692334412235, 1.55545506400612, 0.610753024230973, 0.505378346129865,0.848116005428118, -0.070726617038953, 0.252050044735585, 0.300412777789466,0.151884762998031, 0.813215752731732, -0.286091504364043, 0.512974274351804,0.498832960097125, 0.157492855363047, 0.940976952035365, 0.898786980057024,0.650024905246783, 0.406324757980953, 0.399466179501009, 1.05059167482819,-0.418961174172354, 1.34113776433341, 0.502177374038001, 0.25799162152883,-0.432573434627917, -0.35580794051275, 0.650973561733316, 0.538275369777074,0.284813862403078, 1.25394284878034, 1.0106182358149, -0.00444676621694073,-0.325779809473357, 0.910643354541324, 0.353004958288422, 0.858495202488763,0.306417269758276, -0.12093886777988, 1.90844732985089, 1.51802100667435,0.616352157613486, 0.809564011975922, 1.02065778039265, -0.242918808935179,1.21476458198332, 0.0586569590504177, 0.599531752301977, 0.792877080181068,0.62649752177653, 0.64777825011371, 0.579823608881512, 0.68238739786398,1.27239520573654, 0.465077214254825, 0.884492193518752, 0.961966079585763,0.92321778326986, 0.0990304174483836, 0.906049551252873, 1.0749250379303,0.627324096076292, 2.01164007496878, -0.0175966025264226, 0.665369753162033,1.07698401314904, 1.42785041913011, 1.19968309429415, 0.577004092204133,0.0919051485000802, -0.0727750182118332, 0.504122342843168, 0.657477464772569,0.475350114407543, 0.435638914371231, 0.277389013583051, 1.18408295212953,-0.181915149971896, -0.157391585652537, 0.215605429919063, 0.57411717436601,0.647018717101007, 0.00453023813146353, 0.635386101953004, 0.643431643993217,0.690164994815175, 0.146460339988168, -0.00739880674383986, 0.0523107748643908,1.01425811424139, 1.08772879241752, 0.256339172884531, -0.00766021230631542,0.974592360627304, 0.729460531004349, 0.673749325545974, 0.198358398876754,0.85191209997245, 0.401609305633145, 0.00971269935602426, 0.951562275648985,0.770649210311999, 0.324614915224208, 0.360124589817695, 1.76539528470084,1.03768333477145, 0.551984167481125, 0.311668205491677, 0.292191744915563,0.786510621131108, 0.334376054246913, -0.0322765220573903, 0.268053424437668,1.68906093565915, 0.562444047393945, -0.30001257791487, 1.07947973483349,0.355741859001209, 1.01287349627918, 0.267296726521233, 0.706216071771302,0.828773659079738, 0.71502292912383, 0.013643734905881, 0.28608574423615,0.431840298002694, 0.438419121349729, 0.683488183901015, 0.900813298340846,1.02570194973943, -0.0071467969323542, 0.252989892587643, 0.57809496364319,-0.301931436967686, 0.35192732575064, 0.492779917761036, 0.538072334852348,0.773097231131873, 0.796253624787788, 0.352957081984132, 1.18590349535553,-0.0872092282016209, 0.853728288440627, 0.226028274268147, -0.355922420832915,0.24121945122532, -0.074610263995803, -0.401380645226027, -0.0762966898621786,0.680277278862566, -0.0536051040254401, 0.612172381868706, -0.195414099418422,0.01331085920727, 0.855994631992271, 0.0403133695138903, -0.362468747229651,-0.936589836774112, 0.208653325784809, 1.09276409659208, 1.32116529040581,0.641414670918948, 0.241199492760101, 0.300201985259899, 0.0369394787348632,0.779869047859457, 0.775829580580764, -0.286351414730501, 0.315427119733318,1.56263207969704, 0.715439346611936, 1.11477960193478, 0.345599603237156,0.662307141106793, -0.182516547446907, 0.162058501790905, 0.378192858134883,1.10076044105576, 0.409663465535981, 0.074187246426722, 1.41679668274989,0.528074034296603, 1.51738478927659, 0.544554456690739, 0.526987102815643,0.132573551076517, 0.902823959546753, 0.715708955329887, 0.52908252303701,0.421687761514125, 0.957107940561355, 0.400817090685234, 0.724582945705774,0.45629547071034, 0.617465424873546, 1.31670405318603, 1.21170920766733,0.515081980629748, 0.740368141287455, 0.910281195573676, 0.720828733302589,0.763341629044747, 0.224657047857323, 1.3149089076925, 0.768099028118935,0.442526016152912, 1.08191975136973, 0.496400313299434, 1.2627677236787,0.693128390422344, -0.153580470313715, 1.32351967165958, 1.28517070358287,-0.105670996017762, 0.812317035603965, 0.430492801156368, 0.302731378696669,-0.0635061775058033, 0.564919295934077, 0.568184197702969, 0.847801702692,0.344560907618064, 0.613739230237332, 0.371914427627445, 0.684367820105222,1.16287259114137, 0.0479679512523679, -0.0517518475856887, 0.846745599262882,0.341955714401746, 0.00954249924257355, -0.0658127884965344, 0.711716752950067,0.0755075534559609, 0.017671427707227, 0.271015033344845, 0.524958771970716,0.643323456274383, 1.36213351547958, 0.183750589083828, 0.792424059642369,0.990030773904135, -0.00554716930682553, 0.281707468428514, 0.334339452207651,1.35096291716075, 1.57344462163811, 3.36264097183734, 5.40563419411335,5.77748414332482, 3.931380792644, 1.62877015308321, 2.69044124734531,1.09662199569713, 1.73171732472512, 6.8645886146036, -0.0655663287254344,4.5534993362105, 4.19934718987287, 5.36627263875863, 4.77400232010013,2.68035376007426, 1.65252852271414, 4.22066050278043, 4.71281897341367,4.02100277111898, -1.30590584478561, 2.71429300997517, 4.56907079825978,5.90334195517189, 2.86670083322925, 3.52421322598959, 3.12818314926833,3.14248000431486, 6.93903515345222, 5.06357037008132, 4.6392768673653,6.1458189941106, 3.98015244277773, 4.48761414929311, 6.01564694394002,6.8405487975097, 2.97441449119364, 2.11387412914234, 3.23058673671317,4.18569508097537, 5.27945081805701, 6.23323541229137, 2.98816278825682,1.86110470534611, 2.23648215262013, 7.51016868145402, 3.96382228878122,2.83223651605237, 3.5502284247036, 4.87444747827259, -0.220456381431477,2.37414738223461, 4.10203634722444, 2.65511374322252, 5.01901302298248,2.84186611378776, 1.10713088903563, 4.10071136212268, 0.771372688611323,2.22991607905056, 3.812957096106, 2.46543665884853, 4.49694891998418,2.97253921178903, 3.97367177683895, 2.11302814646024, 3.20215714951831,2.41200589497786, 3.48816748260923, 2.30253616965808, -1.09807618169417,0.24379264438506, 2.02640181646054, 0.646959831995201, -0.221218197492577,5.48789545143547, 5.53102597411009, 3.48563832384954, 3.84257312498486,5.1338256111881, 6.39104623070878, 4.2415092094795, 5.39852588939993,6.03392326989053, 4.37440858004563, 2.19986760068259, 5.7980050341299,2.83700126199588, 0.563785076694955, 5.08489322426495, 2.9537598403833,5.55687342989714, 2.91011654093419, 4.86278683450904, 5.26609389184993,0.563670135755826, 4.61065613369221, 7.63764850704131, 3.14663134814216,3.26157866165605, 3.18623862279853, 1.00663099794657, 1.79157335962537,1.9164379756325, 4.23458764293787, 1.51891956467384, 1.40099786476791,5.74031136779866, 3.4218977181527, 0.876443447084637, 4.7418891758514,2.92508887435014, 3.62153708799553, 2.17574099520161, 0.267056073259512,-2.70833710694535, 4.27175040597527, 6.59760155729254, 1.8418563238459,4.45352810750744, 4.30967555316489, 0.442015095723063, 6.1107416521479,3.93491528827965, 5.11223338563325, 3.16773807759566, 2.55657268339707,4.71919698680295, 3.48928890546161, 5.1829227741417, 5.95759903082585,5.5542945441093, 1.17945264247161, 1.37825720750358, 3.44435813773239,2.71273895867465, 4.41699720337667, 4.31291398369731, -1.41385083052036,0.87056096142305, 6.14625702765714, -1.61217281442388, 1.91346578215374,-0.691319537411113, 3.01969062594073, 3.25827951915715, 5.66535791663897,7.22878808481037, 2.38158773353073, 3.10822286241858, 1.59619838095798,6.66868843972755, 2.23380484431941, 3.48431506424764, 4.58203947543418,3.19491260186441, 2.90235150368592, 0.628572565088909, 1.35350335178705,4.05742611868366, 1.90561408746646, -1.06282344706776, 2.07397629900643,0.589635873602535, 4.52831990877715, 3.20847542662923, 2.03307016095802,5.48432888392861, 6.07193396879275, 4.16737401316063, 5.48795138424049,5.18934818565615, -0.471717409664853, 2.58373357552464, 8.80629115223292,5.21572387077922, 5.65501367431523, 4.37290596099261, 4.08963907565008,5.65237157247473, 3.55700927981317, 2.99458603480759, 1.2281303095066,4.68865967105633, 4.62640930803986, 3.67076249171636, 5.21201806738572,6.24700119052755, 3.23363518447176, 0.328606188150987, 1.73195127808911,5.66000245304712, 2.29164547355687, 4.51780655868676, 4.35676450421781,-0.314664727637637, 4.79039692025602, 1.34772755249227, 0.246582237955305,3.02234080381844] [N]

float ps[K]
vector[K] log_theta
mu_loc := cauchy(0,5)
mu_scale := cauchy(0,5)<lower=0>
sigma := cauchy(0,5)[K]<lower=0>
theta := dirichlet<K>(1234.0)
mu_prop := dirichlet<K>(1234.0)
transformedparam {
vector[K] mu
mu = mu_loc + mu_scale * cumulative_sum(mu_prop)
}

log_theta = log(theta)

for (n in 1:N) {
  for (k in 1:K) {
    ps[k] = log_theta[k]  + normal_log(y[n],mu[k],sigma[k])
  }
  increment_log_prob(log_sum_exp(ps))
}


