K : 2
V : 5
M : 25
N: 262
w : [4, 3, 5, 4, 3, 3, 3, 3, 3, 4, 5, 3, 4, 4, 5,3, 4, 4, 4, 3, 5, 4, 5, 2, 3, 3, 1, 5, 5, 1, 4,3, 1, 2, 5, 4, 4, 3, 5, 4, 2, 4, 5, 3, 4, 1, 4,4, 3, 2, 1, 2, 1, 2, 2, 2, 1, 2, 2, 3, 1, 2, 2,4, 4, 5, 4, 5, 5, 4, 3, 5, 4, 4, 4, 2, 2, 1, 1,2, 1, 3, 1, 2, 1, 1, 1, 3, 2, 3, 3, 5, 4, 5, 4,3, 5, 4, 2, 2, 2, 1, 3, 2, 1, 3, 1, 3, 1, 1, 2,1, 2, 2, 4, 4, 4, 5, 5, 4, 4, 5, 4, 3, 3, 3, 1,3, 3, 4, 2, 1, 3, 4, 4, 5, 4, 4, 4, 3, 4, 3, 4,5, 1, 2, 1, 3, 2, 1, 1, 2, 3, 3, 3, 3, 4, 1, 4,4, 4, 4, 3, 4, 4, 1, 2, 2, 3, 3, 1, 1, 4, 1, 3,1, 5, 3, 2, 2, 1, 1, 2, 3, 3, 4, 4, 5, 3, 4, 3,1, 5, 5, 5, 3, 3, 4, 5, 3, 3, 3, 2, 3, 1, 3, 3,1, 3, 1, 5, 5, 5, 2, 2, 3, 3, 3, 1, 1, 5, 5, 5,3, 1, 5, 4, 1, 3, 3, 3, 3, 4, 2, 5, 1, 3, 5, 2,5, 5, 2, 1, 3, 3, 5, 3, 5, 3, 3, 5, 1, 2, 2, 1,1, 2, 1, 2, 3, 1, 1] [N]
doc : [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2,2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,6, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 8, 8, 8, 8,8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9,9, 9, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,10, 10, 10, 10, 10, 10, 11, 11, 11, 11, 11, 11, 12,12, 12, 12, 13, 13, 13, 13, 13, 13, 13, 13, 13, 14,14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 15, 15, 15,15, 15, 15, 15, 15, 15, 15, 15, 16, 16, 16, 16, 16,16, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17, 17, 17,17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19, 19,19, 19, 19, 19, 19, 19, 19, 20, 20, 20, 20, 20, 20,20, 20, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21,22, 22, 22, 22, 22, 22, 22, 22, 23, 23, 23, 23, 23,23, 23, 23, 23, 23, 24, 24, 24, 24, 24, 24, 24, 24,24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25] [N]
beta : <0.2, 0.2, 0.2, 0.2, 0.2> [V] 
Omega := lkj_corr<K>(2.0)
for (k in 1:K){
    phi[k] := dirichlet<V>(beta)[K]
    }
mu := normal<K>(0,5)
sigma := cauchy<K>(0,5)
transformedparam {
  simplex[K] theta[M]
  cov_matrix[K] Sigma
  for (m in 1:M){
    theta[m] = softmax(eta[m])
    }
  for (m in 1:K) {
    Sigma[m,m] = sigma[m] * sigma[m] * Omega[m,m]
    for (n in (m+1):K) {
      Sigma[m,n] = sigma[m] * sigma[n] * Omega[m,n]
      Sigma[n,m] = Sigma[m,n]
    }
  } 
}

for (m in 1:M){
  eta[m] := multi_normal<K>(mu,Sigma)[M]
  }

for (n in 1:N) {
    float gamma[K]
    for (k in 1:K){
      gamma[k] = log(theta[doc[n],k]) + log(phi[k,w[n]])
      }
    increment_log_prob(log_sum_exp(gamma))
  }